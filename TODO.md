# 工作流程

## 1. 配置文件检查
- 检查用户配置文件是否存在（~/.agcommits/config.json）
  - 如果存在：
    - 验证配置文件格式是否正确
    - 检查必要的配置项是否完整（API密钥、默认语言等）
      - 如果不完整：提示用户补充缺失的配置
  - 如果不存在：
    - 创建配置目录
    - 创建默认配置文件
    - 引导用户完成初始化配置
      - 设置 API 密钥
      - 选择默认语言
      - 其他可选配置项

## 2. Git 仓库检查
- 检查当前目录是否为 Git 仓库
  - 如果是：继续下一步
  - 如果否：询问用户是否要初始化 Git 仓库
    - 用户同意：执行 git init
    - 用户拒绝：退出程序

## 3. 暂存区检查
- 检查是否有文件在暂存区（git add 状态）
  - 如果有：继续下一步
  - 如果没有：询问用户是否要执行 git add .
    - 用户同意：执行 git add .
    - 用户拒绝：退出程序

## 4. 提交消息生成
- 执行 git diff 获取变更内容
- 检查本地配置文件中的语言设置
  - 如果已设置：使用已设置的语言
  - 如果未设置：
    - 显示支持的语言列表
    - 让用户选择偏好语言
    - 保存用户语言选择到配置文件
- 根据 diff 内容和选定语言拼接 AI 提示词
- 调用 AI 接口生成提交消息

## 5. 用户确认
- 向用户展示生成的提交消息
- 询问用户是否确认提交
  - 用户确认：执行 git commit
  - 用户拒绝：询问是否需要重新生成
    - 是：返回到提交消息生成步骤
    - 否：退出程序
